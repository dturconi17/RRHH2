import os
from flask import Flask
from flask import render_template, request, redirect, session
from flaskext.mysql import MySQL
from datetime import datetime, timedelta
from flask import send_from_directory
from tkinter import *
from tkinter import messagebox
from django import template
from django.db import models
from db import *
from usuarios import *
from logueo import *


@app.route('/listar_cronograma')
def listar_cronograma():

        if not 'login' in session:
            return redirect("/login")

        sql = "insert into logueo (fecha, sitio, usuario) values (now(), 'listar_cronograma',%s );"
        datos= (session["usuario"])
        conexion= mysql.connect()
        cursor = conexion.cursor()
        cursor.execute(sql, datos)
        conexion.commit()   

        conexion=mysql.connect()
        cursor=conexion.cursor()
        cursor.execute("select concat(day(curdate()),'-',month(curdate())), concat(day(date_add(curdate(), interval 5 day)),'-',month(date_add(curdate(), interval 5 day))), concat(day(date_add(curdate(), interval 10 day)),'-',month(date_add(curdate(), interval 10 day))), concat(day(date_add(curdate(), interval 15 day)),'-',month(date_add(curdate(), interval 15 day))), concat(day(date_add(curdate(), interval 20 day)),'-',month(date_add(curdate(), interval 20 day))), concat(day(date_add(curdate(), interval 25 day)),'-',month(date_add(curdate(), interval 25 day))), concat(day(date_add(curdate(), interval 30 day)),'-',month(date_add(curdate(), interval 30 day))), concat(day(date_add(curdate(), interval 35 day)),'-',month(date_add(curdate(), interval 35 day))),concat(day(date_add(curdate(), interval 40 day)),'-',month(date_add(curdate(), interval 40 day))),concat(day(date_add(curdate(), interval 45 day)),'-',month(date_add(curdate(), interval 45 day))),concat(day(date_add(curdate(), interval 50 day)),'-',month(date_add(curdate(), interval 50 day))),concat(day(date_add(curdate(), interval 55 day)),'-',month(date_add(curdate(), interval 55 day))),concat(day(date_add(curdate(), interval 60 day)),'-',month(date_add(curdate(), interval 60 day)))")     
        es_hoy=cursor.fetchall()
        conexion.commit
        hoy = es_hoy[0][0]
        cinco = es_hoy[0][1]
        diez = es_hoy[0][2]
        quince = es_hoy[0][3]
        veinte = es_hoy[0][4]
        veinticinco = es_hoy[0][5]
        treinta = es_hoy[0][6]
        treintacinco = es_hoy[0][7]
        cuarenta = es_hoy[0][8]
        cuarentacinco = es_hoy[0][9]
        cincuenta = es_hoy[0][10]
        cincuentacinco = es_hoy[0][11]
        sesenta = es_hoy[0][12]

        
        conexion=mysql.connect()
        cursor=conexion.cursor()
        cursor.execute("SELECT gerencia, jefatura, funcion, (select aprobacion from niveles where id = funcion),(select nivel from niveles where id = funcion) FROM `usuario` where nombre_usuario = %s", (session["usuario"]))
        condicionado=cursor.fetchall()
        conexion.commit
        gerencia = int(condicionado[0][0])
        jefatura = int(condicionado[0][1])
        funcion = int(condicionado[0][2])
        aprobacion = int(condicionado[0][3])
        seniority = str(condicionado[0][4])

        conexion=mysql.connect()
        cursor=conexion.cursor()
        cursor.execute("SELECT id from niveles where nivel = 'Gerente'")
        es_gerente=cursor.fetchall()
        conexion.commit
        id_gerente = int(es_gerente[0][0])
        
        conexion=mysql.connect()
        cursor=conexion.cursor()
        cursor.execute("SELECT id from niveles where nivel = 'Jefe'")
        es_jefe=cursor.fetchall()
        conexion.commit
        id_jefe = int(es_jefe[0][0])
        

        if funcion == 99 or funcion == 108:
            conexion=mysql.connect()
            cursor=conexion.cursor()
            cursor.execute("select empleado, concat(day(desde), '-', month(desde),'-',year(desde)), concat(day(hasta), '-', month(hasta),'-',year(hasta)), now(), case when now() between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia1,case when date_add(now(), interval 2 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia2,case when date_add(now(), interval 3 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia3,case when date_add(now(), interval 4 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia4,case when date_add(now(), interval 5 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia5,case when date_add(now(), interval 6 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia6,case when date_add(now(), interval 7 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia7,case when date_add(now(), interval 8 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia8,case when date_add(now(), interval 9 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia9,case when date_add(now(), interval 10 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia10,case when date_add(now(), interval 11 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia11,case when date_add(now(), interval 12 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia12,case when date_add(now(), interval 13 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia13,case when date_add(now(), interval 14 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia14,case when date_add(now(), interval 15 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia15,case when date_add(now(), interval 16 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia16,case when date_add(now(), interval 17 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia17,case when date_add(now(), interval 18 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia18,case when date_add(now(), interval 19 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia19,case when date_add(now(), interval 20 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia20,case when date_add(now(), interval 21 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia21,case when date_add(now(), interval 22 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia22,case when date_add(now(), interval 23 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia23,case when date_add(now(), interval 24 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia24,case when date_add(now(), interval 25 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia25,case when date_add(now(), interval 26 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia26,case when date_add(now(), interval 27 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia27,case when date_add(now(), interval 28 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia28,case when date_add(now(), interval 29 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia29,case when date_add(now(), interval 30 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia30, case when date_add(now(), interval 31 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia31,case when date_add(now(), Interval 32 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia32,case when date_add(now(), Interval 33 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia33,case when date_add(now(), Interval 34 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia34,case when date_add(now(), Interval 35 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia35,case when date_add(now(), Interval 36 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia36,case when date_add(now(), Interval 37 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia37,case when date_add(now(), Interval 38 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia38,case when date_add(now(), Interval 39 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia39,case when date_add(now(), interval 40 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia40,case when date_add(now(), Interval 41 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia41,case when date_add(now(), Interval 42 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia42,case when date_add(now(), Interval 43 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia43,case when date_add(now(), Interval 44 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia44,case when date_add(now(), Interval 45 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia45,case when date_add(now(), Interval 46 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia46,case when date_add(now(), Interval 47 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia47,case when date_add(now(), Interval 48 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia48,case when date_add(now(), Interval 49 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia49,case when date_add(now(), interval 50 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia50,case when date_add(now(), Interval 51 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia51,case when date_add(now(), Interval 52 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia52,case when date_add(now(), Interval 53 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia53,case when date_add(now(), Interval 54 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia54,case when date_add(now(), Interval 55 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia55,case when date_add(now(), Interval 56 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia56,case when date_add(now(), Interval 57 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia57,case when date_add(now(), Interval 58 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia58,case when date_add(now(), Interval 59 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia59,case when date_add(now(), interval 60 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia60,case when date_add(now(), interval 61 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia61,case when date_add(now(), interval 62 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia62,case when date_add(now(), interval 63 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia63 from vacaciones where desde > now()")
            stock=cursor.fetchall()
            conexion.commit
        
            return render_template("sitio/vacaciones_cronograma.html", stock=stock, hoy=hoy, cinco= cinco, diez=diez, quince=quince, veinte=veinte, veinticinco=veinticinco, treinta = treinta, treintacinco = treintacinco, cuarenta = cuarenta, cuarentacinco = cuarentacinco, cincuenta = cincuenta, cincuentacinco = cincuentacinco, sesenta = sesenta)

        elif funcion == id_gerente:
            conexion=mysql.connect()
            cursor=conexion.cursor()
            cursor.execute("select empleado, concat(day(desde), '-', month(desde),'-',year(desde)), concat(day(hasta), '-', month(hasta),'-',year(hasta)), now(), case when now() between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia1,case when date_add(now(), interval 2 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia2,case when date_add(now(), interval 3 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia3,case when date_add(now(), interval 4 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia4,case when date_add(now(), interval 5 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia5,case when date_add(now(), interval 6 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia6,case when date_add(now(), interval 7 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia7,case when date_add(now(), interval 8 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia8,case when date_add(now(), interval 9 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia9,case when date_add(now(), interval 10 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia10,case when date_add(now(), interval 11 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia11,case when date_add(now(), interval 12 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia12,case when date_add(now(), interval 13 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia13,case when date_add(now(), interval 14 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia14,case when date_add(now(), interval 15 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia15,case when date_add(now(), interval 16 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia16,case when date_add(now(), interval 17 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia17,case when date_add(now(), interval 18 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia18,case when date_add(now(), interval 19 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia19,case when date_add(now(), interval 20 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia20,case when date_add(now(), interval 21 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia21,case when date_add(now(), interval 22 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia22,case when date_add(now(), interval 23 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia23,case when date_add(now(), interval 24 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia24,case when date_add(now(), interval 25 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia25,case when date_add(now(), interval 26 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia26,case when date_add(now(), interval 27 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia27,case when date_add(now(), interval 28 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia28,case when date_add(now(), interval 29 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia29,case when date_add(now(), interval 30 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia30, case when date_add(now(), interval 31 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia31,case when date_add(now(), Interval 32 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia32,case when date_add(now(), Interval 33 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia33,case when date_add(now(), Interval 34 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia34,case when date_add(now(), Interval 35 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia35,case when date_add(now(), Interval 36 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia36,case when date_add(now(), Interval 37 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia37,case when date_add(now(), Interval 38 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia38,case when date_add(now(), Interval 39 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia39,case when date_add(now(), interval 40 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia40,case when date_add(now(), Interval 41 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia41,case when date_add(now(), Interval 42 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia42,case when date_add(now(), Interval 43 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia43,case when date_add(now(), Interval 44 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia44,case when date_add(now(), Interval 45 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia45,case when date_add(now(), Interval 46 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia46,case when date_add(now(), Interval 47 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia47,case when date_add(now(), Interval 48 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia48,case when date_add(now(), Interval 49 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia49,case when date_add(now(), interval 50 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia50,case when date_add(now(), Interval 51 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia51,case when date_add(now(), Interval 52 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia52,case when date_add(now(), Interval 53 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia53,case when date_add(now(), Interval 54 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia54,case when date_add(now(), Interval 55 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia55,case when date_add(now(), Interval 56 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia56,case when date_add(now(), Interval 57 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia57,case when date_add(now(), Interval 58 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia58,case when date_add(now(), Interval 59 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia59,case when date_add(now(), interval 60 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia60,case when date_add(now(), interval 61 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia61,case when date_add(now(), interval 62 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia62,case when date_add(now(), interval 63 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia63 from vacaciones where desde > now() and empleado in (select nombre_usuario from usuario where gerencia = %s) ",(gerencia))     
            stock=cursor.fetchall()
            conexion.commit
        
            return render_template("sitio/vacaciones_cronograma.html", stock=stock, hoy=hoy, cinco= cinco, diez=diez, quince=quince, veinte=veinte, veinticinco=veinticinco, treinta = treinta, treintacinco = treintacinco, cuarenta = cuarenta, cuarentacinco = cuarentacinco, cincuenta = cincuenta, cincuentacinco = cincuentacinco, sesenta = sesenta)
    
        elif funcion == id_jefe:
            conexion=mysql.connect()
            cursor=conexion.cursor()
            cursor.execute("select empleado, concat(day(desde), '-', month(desde),'-',year(desde)), concat(day(hasta), '-', month(hasta),'-',year(hasta)), now(), case when now() between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia1,case when date_add(now(), interval 2 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia2,case when date_add(now(), interval 3 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia3,case when date_add(now(), interval 4 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia4,case when date_add(now(), interval 5 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia5,case when date_add(now(), interval 6 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia6,case when date_add(now(), interval 7 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia7,case when date_add(now(), interval 8 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia8,case when date_add(now(), interval 9 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia9,case when date_add(now(), interval 10 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia10,case when date_add(now(), interval 11 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia11,case when date_add(now(), interval 12 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia12,case when date_add(now(), interval 13 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia13,case when date_add(now(), interval 14 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia14,case when date_add(now(), interval 15 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia15,case when date_add(now(), interval 16 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia16,case when date_add(now(), interval 17 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia17,case when date_add(now(), interval 18 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia18,case when date_add(now(), interval 19 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia19,case when date_add(now(), interval 20 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia20,case when date_add(now(), interval 21 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia21,case when date_add(now(), interval 22 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia22,case when date_add(now(), interval 23 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia23,case when date_add(now(), interval 24 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia24,case when date_add(now(), interval 25 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia25,case when date_add(now(), interval 26 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia26,case when date_add(now(), interval 27 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia27,case when date_add(now(), interval 28 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia28,case when date_add(now(), interval 29 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia29,case when date_add(now(), interval 30 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia30, case when date_add(now(), interval 31 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia31,case when date_add(now(), Interval 32 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia32,case when date_add(now(), Interval 33 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia33,case when date_add(now(), Interval 34 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia34,case when date_add(now(), Interval 35 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia35,case when date_add(now(), Interval 36 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia36,case when date_add(now(), Interval 37 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia37,case when date_add(now(), Interval 38 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia38,case when date_add(now(), Interval 39 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia39,case when date_add(now(), interval 40 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia40,case when date_add(now(), Interval 41 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia41,case when date_add(now(), Interval 42 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia42,case when date_add(now(), Interval 43 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia43,case when date_add(now(), Interval 44 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia44,case when date_add(now(), Interval 45 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia45,case when date_add(now(), Interval 46 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia46,case when date_add(now(), Interval 47 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia47,case when date_add(now(), Interval 48 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia48,case when date_add(now(), Interval 49 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia49,case when date_add(now(), interval 50 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia50,case when date_add(now(), Interval 51 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia51,case when date_add(now(), Interval 52 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia52,case when date_add(now(), Interval 53 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia53,case when date_add(now(), Interval 54 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia54,case when date_add(now(), Interval 55 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia55,case when date_add(now(), Interval 56 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia56,case when date_add(now(), Interval 57 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia57,case when date_add(now(), Interval 58 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia58,case when date_add(now(), Interval 59 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia59,case when date_add(now(), interval 60 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia60,case when date_add(now(), interval 61 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia61,case when date_add(now(), interval 62 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia62,case when date_add(now(), interval 63 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia63 from vacaciones where desde > now() and empleado in (select nombre_usuario from usuario where jefatura = %s)", (jefatura))
            stock=cursor.fetchall()
            conexion.commit
        
            return render_template("sitio/vacaciones_cronograma.html", stock=stock, hoy=hoy, cinco= cinco, diez=diez, quince=quince, veinte=veinte, veinticinco=veinticinco, treinta = treinta, treintacinco = treintacinco, cuarenta = cuarenta, cuarentacinco = cuarentacinco, cincuenta = cincuenta, cincuentacinco = cincuentacinco, sesenta = sesenta)
    
        else:
            conexion=mysql.connect()
            cursor=conexion.cursor()
            cursor.execute("select empleado, concat(day(desde), '-', month(desde),'-',year(desde)), concat(day(hasta), '-', month(hasta),'-',year(hasta)), now(), case when now() between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia1,case when date_add(now(), interval 2 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia2,case when date_add(now(), interval 3 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia3,case when date_add(now(), interval 4 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia4,case when date_add(now(), interval 5 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia5,case when date_add(now(), interval 6 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia6,case when date_add(now(), interval 7 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia7,case when date_add(now(), interval 8 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia8,case when date_add(now(), interval 9 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia9,case when date_add(now(), interval 10 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia10,case when date_add(now(), interval 11 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia11,case when date_add(now(), interval 12 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia12,case when date_add(now(), interval 13 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia13,case when date_add(now(), interval 14 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia14,case when date_add(now(), interval 15 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia15,case when date_add(now(), interval 16 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia16,case when date_add(now(), interval 17 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia17,case when date_add(now(), interval 18 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia18,case when date_add(now(), interval 19 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia19,case when date_add(now(), interval 20 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia20,case when date_add(now(), interval 21 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia21,case when date_add(now(), interval 22 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia22,case when date_add(now(), interval 23 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia23,case when date_add(now(), interval 24 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia24,case when date_add(now(), interval 25 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia25,case when date_add(now(), interval 26 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia26,case when date_add(now(), interval 27 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia27,case when date_add(now(), interval 28 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia28,case when date_add(now(), interval 29 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia29,case when date_add(now(), interval 30 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia30, case when date_add(now(), interval 31 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia31,case when date_add(now(), Interval 32 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia32,case when date_add(now(), Interval 33 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia33,case when date_add(now(), Interval 34 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia34,case when date_add(now(), Interval 35 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia35,case when date_add(now(), Interval 36 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia36,case when date_add(now(), Interval 37 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia37,case when date_add(now(), Interval 38 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia38,case when date_add(now(), Interval 39 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia39,case when date_add(now(), interval 40 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia40,case when date_add(now(), Interval 41 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia41,case when date_add(now(), Interval 42 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia42,case when date_add(now(), Interval 43 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia43,case when date_add(now(), Interval 44 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia44,case when date_add(now(), Interval 45 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia45,case when date_add(now(), Interval 46 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia46,case when date_add(now(), Interval 47 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia47,case when date_add(now(), Interval 48 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia48,case when date_add(now(), Interval 49 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia49,case when date_add(now(), interval 50 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia50,case when date_add(now(), Interval 51 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia51,case when date_add(now(), Interval 52 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia52,case when date_add(now(), Interval 53 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia53,case when date_add(now(), Interval 54 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia54,case when date_add(now(), Interval 55 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia55,case when date_add(now(), Interval 56 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia56,case when date_add(now(), Interval 57 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia57,case when date_add(now(), Interval 58 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia58,case when date_add(now(), Interval 59 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia59,case when date_add(now(), interval 60 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia60,case when date_add(now(), interval 61 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia61,case when date_add(now(), interval 62 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia62,case when date_add(now(), interval 63 day) between desde and hasta then  'rgb(165, 227, 183)' else 'white' end as dia63 from vacaciones where desde > now() and empleado = %s", (session["usuario"]))
            stock=cursor.fetchall()
            conexion.commit
        
            return render_template("sitio/vacaciones_cronograma.html", stock=stock, hoy=hoy, cinco= cinco, diez=diez, quince=quince, veinte=veinte, veinticinco=veinticinco, treinta = treinta, treintacinco = treintacinco, cuarenta = cuarenta, cuarentacinco = cuarentacinco, cincuenta = cincuenta, cincuentacinco = cincuentacinco, sesenta = sesenta)
